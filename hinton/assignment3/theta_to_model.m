function ret = theta_to_model(theta)  % This function takes a model (or gradient) in the form of one long vector (maybe produced by model_to_theta), and restores it to the structure format, i.e. with fields .input_to_hid and .hid_to_class, both matrices.  #fprintf('theta_to_model %d\n %dx%d', rows(theta),columns(theta));  n_hid = size(theta, 1) / (256+10);  fprintf('theta_to_model theta %dx%d n_hid:%d\n',rows(theta),columns(theta),n_hid);  ret.input_to_hid = transpose(reshape(theta(1: 256*n_hid), 256, n_hid));  ret.hid_to_class = reshape(theta(256 * n_hid + 1 : size(theta,1)), n_hid, 10).';  #fprintf('%d ',ret.input_to_hid(1:20));  fprintf('ret.input_to_hid %dx%d\n',rows(ret.input_to_hid), columns(ret.input_to_hid));  fprintf('ret.hid_to_class %dx%d\n',rows(ret.hid_to_class), columns(ret.hid_to_class));   end